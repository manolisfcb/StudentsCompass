<header>
    {% include "includes/navbar.html" %}
</header>

<script>
    const logoutLink = document.getElementById('logout-link');
    if (logoutLink) {
        logoutLink.addEventListener('click', async (e) => {
            e.preventDefault();
            if (!confirm('Are you sure you want to log out?')) return;

            try {
                await fetch('/auth/jwt/logout', {
                    method: 'POST',
                    credentials: 'include',
                });
            } catch (err) {
                console.error('Logout error:', err);
            } finally {
                // Cleanup any legacy tokens to avoid client-side redirects
                localStorage.removeItem('bearer_token');
                localStorage.removeItem('company_token');
                localStorage.removeItem('account_type');
                window.location.href = '/login';
            }
        });
    }

    const menuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');

    if (menuToggle && mobileMenu) {
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('active');
        });

        document.addEventListener('click', (event) => {
            if (!mobileMenu.contains(event.target) && !menuToggle.contains(event.target)) {
                mobileMenu.classList.remove('active');
            }
        });
    }
</script>
